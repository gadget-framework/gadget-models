# ---------------------------------------------------------------------
# make faked hunting, culling, gillnet catch files
hunt.catch.rin <-
  structure(rbind(expand.grid(year=1991:2020,step=1:4,area=1,fleet="hunt",number=1)),
            area_group = mfdb_group(`1` = 1))
cull.catch.rin <- gill.catch.rin <- hunt.catch.rin
cull.catch.rin$fleet <- "cull"
gill.catch.rin$fleet <- "gill"

# make faked acoustic survey (for acoustic index LH)
aco.catch.rin <-
  structure(rbind(expand.grid(year=1991:2020,step=1,area=1,fleet="aco.rin",number=1)),
            area_group = mfdb_group(`1` = 1))

# ---------------------------------------------------------------------
## write to file
tmp <- gadgetfleet('Modelfiles/fleet',gd$dir,missingOkay = TRUE) %>%
# hunting
  gadget_update('numberfleet',
                name = 'hunt',
                suitability =
                paste0('\n',
                         paste(c('rinimm','rinmat'),
                               ## 'function','exponentiall50',
                               ## '#rin.hun.alpha','#rin.hun.l50',
                               'function','constant',
                               '#rin.hun.alpha',
                               collapse='\n')),
                data = hunt.catch.rin) %>%
# faked acoustic
  gadget_update('numberfleet',
                name = 'aco.rin',
                suitability =
                paste0('\n',
                         paste(c('rinimm','rinmat'),
                               'function','constant',
                               '#rin.aco.alpha',
                               collapse='\n')),
                data = aco.catch.rin) ## %>%
## # culling
##   gadget_update('numberfleet',
##                 name = 'cull',
##                 suitability =
##                 paste0('\n',
##                          paste(c('rinimm','rinmat'),
##                                'function','exponentiall50',
##                                '#rin.cul.alpha','#rin.cul.l50',
##                                collapse='\n')),
##                 data = cull.catch.rin) %>%
## # fishing
##   gadget_update('linearfleet',
##                 name = 'gillnet',
##                 ## livesonareas = 1,
##                 suitability = 
##                   paste0('\n',
##                          paste(c('rinimm','rinmat'),
##                                'function','exponentiall50',
##                                '#rin.gil.alpha','#rin.gil.l50',
##                                collapse='\n')),
##                 data = gill.catch.rin)

# Fix strange Rgadget behaviour (bug?)
## tmp[2]$component$livesonareas <- 1
## tmp[2]$component$amount$data$area <- 1
## tmp[3]$component$livesonareas <- 1
## tmp[3]$component$amount$data$area <- 1
## tmp[4]$component$livesonareas <- 1
## tmp[4]$component$amount$data$area <- 1
## tmp[5]$component$livesonareas <- 1
## tmp[5]$component$amount$data$area <- 1
write.gadget.file(tmp, gd$dir)
